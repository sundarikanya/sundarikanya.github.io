<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MODEL HUB</title>
    <link rel="icon" type="image/x-icon" href="apple-touch-icon.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="csssearch.css">
    <style>
        .logo {
          cursor: pointer;
        }
    </style>

</head>

<body>



    <header class="bg-white shadow-sm p-3 mb-3">
        <div class="container-fluid d-flex justify-content-between align-items-center flex-wrap">
            <div class="logo" id="logoClick">
                MODEL
                <img src="swimsuit_4813557.png" alt="Logo Icon"> HUB

            </div>
            <div class="search-box">
                <button class="btn-search" id="searchBtn"><i class="fas fa-search"></i></button>
                <input type="text" class="input-search" id="searchInput" placeholder="Type to Search...">
            </div>

            <ul id="categoryList" class="keywords list-inline mb-0"></ul>
        </div>
    </header>




    <!-- Main Layout -->
    <div class="container-fluid">
        <div class="row">

                <!-- Left Sidebar -->
            <div class="col-md-2 sidebar bg-light">
                <div id="7SAD15689C6AA44F451" data-7pub="7SAD15689C6AA44F451"></div>
                      <script src="https://code.adclickppc.com/7s-banner-ad.js"></script>
                      <script>
                      (function() {
                        initBannerAd(['7SAD15689C6AA44F451', 'banner',  2])
                        }())
                      </script>
            </div>

            <!-- Center Cards -->
            <div class="col-md-8">
                <div class="row g-3" id="video-container">
                    <!-- Cards will be injected here -->
                </div>

                <!-- Pagination Controls -->
                <div class="d-flex justify-content-center my-4">
                    <button id="prevBtn" class="btn btn-outline-primary mx-2">Previous</button>
                    <button id="nextBtn" class="btn btn-primary mx-2">Next Page</button>
                </div>
            </div>

            <div class="col-md-2 sidebar bg-light">
              <div id="7SAD15689C6AA44F452" data-7pub="7SAD15689C6AA44F452"></div>
                      <script src="https://code.adclickppc.com/7s-banner-ad.js"></script>
                      <script>
                      (function() {
                        initBannerAd(['7SAD15689C6AA44F452', 'banner',  2])
                        }())
                      </script>

            </div>

        </div>
    </div>

    <script>
        async function loadTopCategories() {
            const categoryList = document.getElementById("categoryList");
        
            try {
                const response = await fetch("https://sundarikanya.vercel.app/api/get/bestcategory");
                const result = await response.json();
        
                categoryList.innerHTML = "";
        
                if (result.status === "success" && result.best_categories.length > 0) {
                    const topCategories = result.best_categories.slice(0, 6); // You can change limit here
        
                    topCategories.forEach((cat, index) => {
                        const li = document.createElement("li");
                        li.className = "list-inline-item";
        
                        const button = document.createElement("button");
                        button.className = "text-secondary category-btn";
                        button.setAttribute("data-category", cat.category);
                        button.innerText = cat.category;
        
                        li.appendChild(button);
                        categoryList.appendChild(li);
        
                        if (index !== topCategories.length - 1) {
                            const separator = document.createElement("li");
                            separator.className = "list-inline-item text-secondary";
                            separator.innerText = "|";
                            categoryList.appendChild(separator);
                        }
                    });
        
                     document.querySelectorAll('.category-btn').forEach(button => {
                      button.addEventListener('click', () => {
                          const category = button.getAttribute('data-category');
                          window.location.href = `search.html?category=${encodeURIComponent(category)}`;
                      });
                      });
        
                } else {
                    categoryList.innerHTML = "<li class='list-inline-item'>No categories found</li>";
                }
            } catch (error) {
                categoryList.innerHTML = "<li class='list-inline-item text-danger'>Failed to load categories</li>";
            }
        }
        
        loadTopCategories();
    </script>


    <script>
        let currentPage = 1;
        let currentQuery = '';       
        let currentCategory = '';   
        
        
        
        function loadVideos(pageFromClick) {
          const params = new URLSearchParams(window.location.search);
          const query = params.get("query");
          const category = params.get("category");
          const page = parseInt(params.get("page")) || pageFromClick || 1;
        
          currentPage = page;
          currentQuery = query || '';
          currentCategory = category || '';
        
          const container = document.getElementById('video-container');
          container.innerHTML = '';
        
          let baseUrl = '';
          if (query) {
            baseUrl = `https://sundarikanya.vercel.app/api/get/search?query=${encodeURIComponent(query)}&page=${page}`;
          } else if (category) {
            baseUrl = `https://sundarikanya.vercel.app/api/get/sundarikanya1?category=${encodeURIComponent(category)}&page=${page}`;
          } else {
            container.innerHTML = "<h4 class='text-center my-5'>Invalid request.</h4>";
            return;
          }
        
          fetch(baseUrl)
            .then(res => res.json())
            .then(response => {
              const data = response.data;
        
              if (!data || data.length === 0) {
                container.innerHTML = "<h4 class='text-center my-5'>No videos found.</h4>";
                return;
              }
        
              data.forEach(video => {
                const card = `
                  <div class="col-6 col-md-4 col-lg-2-4">
                    <a href="video.html?id=${video.id}" class="text-decoration-none text-dark">
                      <div class="outer-card">
                        <div class="inner-box">
                          <div class="thumbnail-wrapper">
                            <img class="thumb" src="${video.thumbnail}" alt="Thumbnail">
                          </div>
                          <div class="video-title">${video.title}</div>
                        </div>
                      </div>
                    </a>
                  </div>`;
                container.insertAdjacentHTML('beforeend', card);
              });
        
            })
            .catch(error => {
              console.error("Error loading videos:", error);
              container.innerHTML = "<h4 class='text-center my-5 text-danger'>Failed to load videos.</h4>";
            });
        }
        
        
        loadVideos(currentPage);
        
        
        
        function updateURLParams(page) {
          const params = new URLSearchParams(window.location.search);
          if (params.has("query")) {
            params.set("page", page);
            history.pushState({}, '', `?query=${params.get("query")}&page=${page}`);
          } else if (params.has("category")) {
            params.set("page", page);
            history.pushState({}, '', `?category=${params.get("category")}&page=${page}`);
          }
        }
        
        
        document.getElementById('prevBtn').addEventListener('click', () => {
          if (currentPage > 1) {
            currentPage--;
            updateURLParams(currentPage);
            loadVideos(currentPage);
          }
        });
        
        document.getElementById('nextBtn').addEventListener('click', () => {
          currentPage++;
          updateURLParams(currentPage);
          loadVideos(currentPage);
        });
        
        
        
        // Search input
        document.getElementById('searchBtn').addEventListener('click', () => {
          const query = document.getElementById('searchInput').value.trim();
          if (query) {
            const encoded = encodeURIComponent(query);
            window.location.href = `search.html?query=${encoded}`;
          }
        });
        
        
        document.getElementById('searchInput').addEventListener('keyup', (e) => {
          if (e.key === 'Enter') {
            document.getElementById('searchBtn').click();
          }
        });
        
        // Category filter
        document.querySelectorAll('.category-btn').forEach(button => {
          button.addEventListener('click', () => {
            currentCategory = button.getAttribute('data-category');
            currentQuery = '';  // Clear search
            currentPage = 1;
            loadVideos(currentPage);
          });
        });
    </script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>

    <script>
        document.getElementById('logoClick').addEventListener('click', () => {
            window.location.href = 'index.html';
          });
    </script>

</body>

</html>